{% extends "base.html" %}
{% block title %}Lieferscheine{% endblock %}
{% block content %}
    <div style="display: flex;
                justify-content: space-between;
                align-items: center;
                margin-bottom: 2rem">
        <h1>ðŸ“¦ Alle Lieferscheine</h1>
        <a href="{{ url_for('create_delivery_note') }}" class="btn btn-primary">+ Neuer Lieferschein</a>
    </div>
    <div class="card">
        {% if delivery_notes %}
            <table>
                <thead>
                    <tr>
                        <th>Lieferscheinnr.</th>
                        <th>Reseller</th>
                        <th>Lieferdatum</th>
                        <th>Gesamtwert</th>
                        <th>Status</th>
                        <th>Aktionen</th>
                    </tr>
                </thead>
                <tbody>
                    {% for dn in delivery_notes %}
                        <tr>
                            <td>
                                <strong>{{ dn.delivery_note_number }}</strong>
                            </td>
                            <td>
                                {% if dn.customer.company_name %}
                                    {{ dn.customer.company_name }}
                                {% else %}
                                    {{ dn.customer.first_name }} {{ dn.customer.last_name }}
                                {% endif %}
                            </td>
                            <td>{{ dn.delivery_date.strftime("%d.%m.%Y") }}</td>
                            <td>
                                <strong>{{ "%.2f"|format(dn.calculate_total() ) }} â‚¬</strong>
                            </td>
                            <td>
                                {% if dn.status == 'delivered' %}
                                    <span class="badge" style="background: #3498db; color: white;">Ausgeliefert</span>
                                {% elif dn.status == 'partially_billed' %}
                                    <span class="badge" style="background: #f39c12; color: white;">Teilweise abgerechnet</span>
                                {% elif dn.status == 'billed' %}
                                    <span class="badge badge-paid">Komplett abgerechnet</span>
                                {% endif %}
                            </td>
                            <td>
                                <a href="{{ url_for('view_delivery_note', delivery_note_id=dn.id) }}"
                                   class="btn btn-primary"
                                   style="padding: 0.4rem 0.8rem;
                                          font-size: 0.875rem">Ansehen</a>
                                <a href="{{ url_for('download_delivery_note_pdf', delivery_note_id=dn.id) }}"
                                   class="btn btn-success"
                                   style="padding: 0.4rem 0.8rem;
                                          font-size: 0.875rem">PDF</a>
                                <a href="{{ url_for('consignment_stock_overview', customer_id=dn.customer_id) }}"
                                   class="btn"
                                   style="padding: 0.4rem 0.8rem;
                                          font-size: 0.875rem;
                                          background: #9b59b6;
                                          color: white">Lager</a>
                            </td>
                        </tr>
                    {% endfor %}
                </tbody>
            </table>
        {% else %}
            <p>Keine Lieferscheine vorhanden.</p>
        {% endif %}
    </div>
{% endblock %}
